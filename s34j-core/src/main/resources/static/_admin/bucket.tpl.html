<div ng-controller="BucketController">
    <section ng-show="buckets" layout="column" layout-gt-sm="row" flex>
        <section layout="column" class="bg-white s34j-card-shadow" flex="70" layout-margin
                 style="max-height: calc( 100% - 20px );overflow-x: hidden;">
            <md-list style="padding-bottom: 0;margin-bottom: 0;">
                <md-list-item ng-show="!isSelecting()">
                    <md-input-container class="s34j-input-no-error" flex>
                        <label>Prefix</label>
                        <input type="text" ng-model="prefix" ng-keypress="onPrefixKeyPress($event);">
                    </md-input-container>
                </md-list-item>
                <md-list-item ng-show="isSelecting()" style="height: 70px">
                    <md-button class="md-icon-button md-primary" aria-label="select all" ng-click="selectAll();">
                        <md-icon md-font-icon="far fa-check-square s34j-icon"></md-icon>
                    </md-button>
                    <div class="md-list-item-text" layout="row">
                        <p>{{selectCount()}} selected.</p>
                        <md-button class="md-primary">Copy</md-button>
                        <md-button class="md-accent">Delete</md-button>
                    </div>
                    <md-button class="md-icon-button md-secondary" aria-label="de-select all" ng-click="selectNone();">
                        <md-icon md-font-icon="fa fa-times s34j-icon"></md-icon>
                    </md-button>
                </md-list-item>
            </md-list>
            <md-list class="md-dense" style=";overflow-y: scroll;padding-top:0;margin-top:0;">
                <md-list-item ng-repeat="commonPrefix in commonPrefixes"
                              ng-href="#!/s3/{{bucketName}}/{{commonPrefix.Prefix}}">
                    <md-button class="md-icon-button" aria-label="icon"
                               ng-href="#!/s3/{{bucketName}}/{{commonPrefix.Prefix}}">
                        <md-icon md-font-icon="fa fa-folder-open s34j-icon"></md-icon>
                    </md-button>
                    <p>{{commonPrefix.Prefix}}</p>
                </md-list-item>
                <md-list-item ng-repeat="object in objects" ng-click="objectClicked(object,$index);" class="md-2-line">
                    <md-menu>
                        <md-button class="md-icon-button" aria-label="menu" ng-click="$mdMenu.open($event);"
                                   ng-attr-id="{{'menu-'+$index}}">
                            <md-icon md-font-icon="far {{getIcon(object.Key)}} s34j-icon"></md-icon>
                        </md-button>
                        <md-menu-content>
                            <md-menu-item>
                                <md-button ng-click="selectObjectClicked(object);">
                                    <md-icon md-font-icon="far fa-check-square"></md-icon>
                                    Select
                                </md-button>
                            </md-menu-item>
                            <md-menu-item>
                                <md-button ng-click="openObjectClicked(object);">
                                    <md-icon md-font-icon="fa fa-eye"></md-icon>
                                    Open
                                </md-button>
                            </md-menu-item>
                            <md-menu-item>
                                <md-button ng-click="copyLink(object);" class="md-primary">
                                    <md-icon md-font-icon="fa fa-link"></md-icon>
                                    Direct Link
                                </md-button>
                            </md-menu-item>
                            <md-menu-item>
                                <md-button ng-click="copyLink(object,true);" class="md-primary">
                                    <md-icon md-font-icon="fa fa-external-link-alt"></md-icon>
                                    Signed Link
                                    <small>(expires in 7 days.)</small>
                                </md-button>
                            </md-menu-item>
                            <md-menu-item>
                                <md-button class="md-accent">
                                    <md-icon md-font-icon="fa fa-trash"></md-icon>
                                    Delete
                                </md-button>
                            </md-menu-item>
                        </md-menu-content>
                    </md-menu>
                    <div class="md-list-item-text" layout="column">
                        <span class="s34j-truncate" style="font-size: 15px;">
                            {{object.Key}}
                        </span>
                        <p>
                            <small>{{object.LastModified | date:'medium' }}</small>
                            <span style="color:#3f51b5">{{ object.Size | bytes:2 }}</span>
                        </p>
                    </div>
                </md-list-item>
                <md-list-item ng-show="isTruncated && !loading">
                    <md-button class="md-warn" ng-click="loadMore();" style="width: 100%;">Load more</md-button>
                </md-list-item>
            </md-list>
        </section>
        <section layout="column" flex-gt-sm="35">
            <connection-info></connection-info>
            <div style="height:50px"></div>
        </section>
    </section>
</div>
